{% comment %}

  @param menu {Linklist} [Optional] Linklist for which to render nav items.

{% endcomment %}

{% comment %} <ul class="widemenu">
  {% for menu_item in menu.links %}
    {% if linklists[menu_item.handle].links.size > 0 %}
      <li class="widemenu__submenu">
        <a href="{{ menu_item.url }}" class="widemenu__submenu-heading widemenu__link">
          {{ menu_item.title | escape }}
        </a>
        <ul class="widemenu__submenu-items">
        {% for sub_item in linklists[menu_item.handle].links %}
          <li class="widemenu__submenu-item">
            <a href="{{ sub_item.url }}" class="widemenu__submenu-item-link widemenu__link">
              {{ sub_item.title | escape }}
            </a>
          </li>
        {% endfor %}
        </ul>
      </li>
    {% else %}
      <li class="widemenu__item">
        <a href="{{ menu_item.url }}" class="widemenu__item-heading widemenu__link">
          {{ menu_item.title | escape }}
        </a>
      </li>
    {% endif %}
  {% endfor %}
</ul> {% endcomment %}

{% comment %}

  @param menu {Linklist} [Optional] Linklist for which to render nav items.

{% endcomment %}

{% assign childLinksSize = false  %}
{% for menu_item in menu.links %}
  {% if linklists[menu_item.handle].links.size > 0 %}
    {% assign childLinksSize = true  %}
  {% endif %}
{% endfor %}
  
<div class="widemenu widemenu-panels" {% if childLinksSize == false %} style="display: flex; justify-content: center; width: 100%;" {% endif %}>
  
  <ul style="list-style-type: none; margin: 0; {% if childLinksSize == false %} width: 25%; padding: 0; {% endif %}">
    {% for menu_item in menu.links %}
      {% if linklists[menu_item.handle].links.size > 0 %}
        <li class="widemenu__submenu {% if forloop.index0 == 0 %} active{% endif %}" data-menu="{{ linklists[menu_item.handle].title }}">
          <a href="{{ menu_item.url }}" class="widemenu__submenu-heading widemenu__link">
            {{ menu_item.title | escape }}
          </a>
        </li>
      {% else %}
        <li class="widemenu__item">
          <a href="{{ menu_item.url }}" class="widemenu__item-heading widemenu__link">
            {{ menu_item.title | escape }}
          </a>
        </li>
      {% endif %}
    {% endfor %}
  </ul>
  <div class="child-links-panel" {% if childLinksSize == true %} style="display: block;" {% else %} style="display: none;" {% endif %}>
    {% for menu_item in menu.links %}
      
      <div class="child_links_panel_links {% if forloop.index0 == 0 %} active{% endif %}" data-menu="{{ linklists[menu_item.handle].title }}">
        {% if linklists[menu_item.handle].links.size > 0 %}
          <li class="widemenu__submenu-items-link-list">
            <ul class="widemenu__submenu-items">
            {% for sub_item in linklists[menu_item.handle].links %}
              <li class="widemenu__submenu-item" data-menu="{{ sub_item.title }}">
                <a href="{{ sub_item.url }}" class="widemenu__submenu-item-link widemenu__link">
                  {{ sub_item.title | escape }}
                </a>
              </li>
            {% endfor %}
            </ul>
          </li>
        {% else %}
          <li class="widemenu__item">
            <a href="{{ menu_item.url }}" class="widemenu__item-heading widemenu__link">
              {{ menu_item.title | escape }}
            </a>
          </li>
        {% endif %}
        
        {% for sub_item in linklists[menu_item.handle].links %}
          {% if sub_item.url contains 'collections' %}
            {% assign collectionItem = sub_item.url | remove: 'collections/' %}
            {% assign collectionItem = collectionItem | remove: '/' %}
            
            <div class="sub-link-product {% if forloop.index == 1 %} active{%endif %}" data-menu="{{ sub_item.title }}">
              {% for product in collections[collectionItem].products limit: 2 %}
                <a href="{{ product.url }}" class="product-card">
                  <div class="product-card__image">
                    <img src="{{ product.featured_image | img_url: 'master' }}" alt="{{ product.alt }}" />
                  </div>
                  <div class="product-card__product-information">
                    <p>{{ product.title }}</p>
                    <p>{{ product.price | money }}</p>
                  </div>
                </a>
              {% endfor %}
            </div>
          {% endif %}
          
          {% if sub_item.url contains 'products' %}
            {% for block in section.blocks %}
              {% case block.type %}
                {% when 'product_option' %}
                  
                  {% if sub_item.title == block.settings.menu_item %}
                    <div class="sub-link-product {% if forloop.index == 1 %} active{% endif %}" data-menu="{{ sub_item.title }}">
                      {% for i in (0..1) %}
                        {% assign productNum = 'product_' | append: i %}
                        {% assign productType = block.settings[productNum] %}
                        <a href="{{ productType.url }}" class="product-card">
                          <div class="product-card__image">
                            <img src="{{ productType.featured_image | img_url: 'master' }}" alt="{{ productType.featured_image.alt }}" />
                          </div>
                          <div class="product-card__product-information">
                            <p>{{ productType.title }}</p>
                            <p>{{ productType.price | money }}</p>
                          </div>
                        </a> 
                      {% endfor %}
                    </div>
                  {% endif %}
                  
                {% when 'collection_option' %}
                  
                  {% if sub_item.title == block.settings.menu_item %}
                    <div class="sub-link-product {% if forloop.index == 1 %} active{% endif %}" data-menu="{{ sub_item.title }}">
                      {% for product in collections[block.settings.collection_item].products limit: 2 %}
                        <a href="{{ product.url }}" class="product-card">
                          <div class="product-card__image">
                            <img src="{{ product.featured_image | img_url: 'master' }}" alt="{{ product.alt }}" />
                          </div>
                          <div class="product-card__product-information">
                            <p>{{ product.title }}</p>
                            <p>{{ product.price | money }}</p>
                          </div>
                        </a>
                      {% endfor %}
                    </div>
                  {% endif %}
                  
              {% endcase %}
            {% endfor %}
          {% endif %}
        {% endfor %}
        
      </div>
    {% endfor %}
  </div>
  
</div>

